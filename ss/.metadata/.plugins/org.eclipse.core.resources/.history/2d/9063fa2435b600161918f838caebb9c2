package week2.hotel;

public class Hotel {

	// ---vars
	public Guest guest;
	public Room room101;
	public Room room102;
	public String guestName;
	public String hotelName;
	private Password password;
	

	// ---constructor
	public Hotel(String name) {
		this.hotelName = name;
		this.room101 = new Room(101);
		this.room102 = new Room(102);
		this.password = new Password();
		
	}
	
	// ---queries
	
	// @ ensures /result = room && room.getGuest() = null;
	/* @ pure */ public Room getFreeRoom() {
		if (room101.getGuest() == null){
			return room101;
			}
	
		if (room102.getGuest() == null){
			return room102;
			}
		
		return null;
	}
	
	
	// @ requires guestName != "" && guestName != null;
	// @ ensures /result = true || /result = false;
	/* @ pure */ public Room getRoom(String guestName) {
		if (guest.getName() != guestName){
			return null;
		} else {
			guest = new Guest(guestName);
			return guest.getRoom();
		}
	}

	// @ ensures /result = password;
	/* @ pure */ public Password getPassword() {
		return this.password;
	}

	 public String toString() { 
		  String output = ""; 
		   output += guest + "\n"; 
		   if (guest.getRoom() == null) { 
		    output += "Guest without room " + guest.getName() + "\n";
		    } 
		  return output; 
		  } 

//	 ---commands

	 /**
	  *@ requires pwAttempt != null && pwAttempt != "" 
	  *@ requires guestName != null && guestName != "" 
	  * @param password 
	  * @param guestname 
	  * @return 
	  */ 
	public Room checkIn(String pwAttempt, String guestName) {
		Room freeRoom = this.getFreeRoom();
		if (!getPassword().testWord(pwAttempt) || freeRoom == null) {
			return null;
		}
		
		guest = new Guest(guestName);
		guest.checkin(freeRoom);
		freeRoom.setGuest(guest);
		return freeRoom;
	}


	// @ requires password.length() >= 6 && !password.contains(" ");
	public void checkOut(String guestName) {
		if (guest.getName() == guestName) { 
		    Room room = guest.getRoom(); 
		    if (guest.checkout()) { 
		     room.setGuest(null); 
		     room.getSafe().deactivate(); 
		     room.getSafe().close(); 
		    } 
		   } 
	}

}
